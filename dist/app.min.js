function initializeMap(){var e=squid.getCoordinates();geocoder=new google.maps.Geocoder,map=new google.maps.Map(document.getElementById("map-canvas"),e),$("#map-canvas").append(map),getMarkers()}function getMarkers(){var e=squid.getLocations();e.forEach(function(e,o){geocoder.geocode({address:e.address},function(n,a){if(a==google.maps.GeocoderStatus.OK){var t=new google.maps.Marker({map:map,position:n[0].geometry.location,animation:google.maps.Animation.DROP,title:e.name}),r=new google.maps.InfoWindow({content:""});google.maps.event.addListener(t,"click",function(){$("li:contains("+t.title+")").trigger("click"),console.log(t.title)}),google.maps.event.addListener(t,"mouseover",function(){$("li:contains("+t.title+")").trigger("mouseover"),console.log(t.title)}),google.maps.event.addListener(t,"mouseout",function(){$("li:contains("+t.title+")").trigger("mouseout"),console.log(t.title)}),squid.addMarker(t,r,o)}else alert("Geocode was not successful for the following reason: "+a)})})}function createInfo(){}var model={date:function(){var e=new Date;return year=e.getFullYear().toString(),day=e.getDate()<10?"0"+e.getDate().toString():e.getDate().toString(),month=e.getMonth()<10?"0"+e.getMonth().toString():e.getMonth().toString(),year+month+day},area:{city:"Reno",state:"Nevada",coordinates:{center:{lat:39.5579311,lng:-119.8508414},zoom:12}},places:[{name:"Campo",address:"50 N Sierra St, Reno, NV",phone:"775.737.9555"},{name:"Stone House Cafe",address:"1907 S Arlington Ave, Reno, NV",phone:"775.284.3895"},{name:"LuLou's",address:"1470 S Virginia St, Reno, NV",phone:"775.329.9979"},{name:"Reef Sushi",address:"50 N Sierra St, Reno, NV",phone:"775.800.1388"},{name:"4th St. Bistro",address:"3065 W 4th St, Reno, NV",phone:"775.323.3200"},{name:"Sup Restaurant",address:"669 S Virginia St, Reno, NV",phone:"775.324.4787"},{name:"BJ's BBQ",address:"80 E Victorian Ave, Sparks, NV"},{name:"Beaujolais",address:"753 Riverside Dr, Reno, NV"},{name:"Pegs Glorified Ham N Eggs",address:"6300 Mae Anne Ave, Reno, NV"},{name:"Centro Bar & Kitchen",address:"236 California Ave, Reno, NV"},{name:"The Brewer's Cabinet",address:"475 S Arlington Ave, Reno, NV"}]},squid={getCoordinates:function(){return model.area.coordinates},getLocations:function(){return model.places},addMarker:function(e,o,n){model.places[n].marker=e,model.places[n].infowindow=o},addInfo:function(e,o){}},viewModel=function(){var e,o=this,n=model.date(),a="https://api.foursquare.com/v2/venues/search?query=",t="https://api.foursquare.com/v2/venues/",r="&client_id=5GCBYWBXFXKG2X0KPKQE4YLOBPD2PYX1RRRE11EGRDG41WBW&client_secret=JQGGN4IDCCFZZW1A4HQFY513DIC4N3AJETVXVK0ZNFBLPLYA",s="&v="+n;o.venue,o.categories=ko.observableArray([]),o.showMe=ko.observable(!1),o.img=ko.observable(""),o.imgText=ko.observable(""),o.photos=[],o.restaurantName=ko.observable(""),o.restaurantAddress=ko.observable(""),o.restaurantPhone=ko.observable(""),o.restaurantStatus=ko.observable(""),o.restaurantHours=ko.observable(""),o.menuUrl=ko.observable(""),o.menuText=ko.observable(""),o.websiteUrl=ko.observable(""),o.websiteText=ko.observable(""),o.filterText=ko.observable(""),o.places=ko.observableArray(model.places),o.places().forEach(function(e){e.showRestaurant=ko.observable(!0)}),o.filterRestaurant=function(){this.places().forEach(function(n){e=n.name.toUpperCase(),0==e.indexOf(o.filterText().toUpperCase())?(n.showRestaurant(!0),n.marker.setMap(map)):(n.showRestaurant(!1),n.marker.setMap(null))})},o.displayDetails=function(e){var n;categories([]),o.img(""),o.showMe(!1),o.menuUrl(""),o.menuText(""),o.websiteUrl(""),o.websiteText(""),o.restaurantName(""),o.restaurantAddress(""),o.restaurantPhone(""),o.restaurantStatus(""),$.ajax({url:a+e.name+"&near="+e.address+"&intent=match"+r+s,dataType:"json",success:function(o){void 0!=o.response.venues[0]?(getFoursquareObject(n=o.response.venues[0].id+"?",e),console.log(e.response)):fourSquareError()},error:function(){fourSquareError()}})},o.getFoursquareObject=function(e,n){$.ajax({url:t+e+r+s,dataType:"json",success:function(e){venue=e.response.venue,showMe(!0),o.restaurantName(venue.name),console.log(venue),"menu"in venue?(menuUrl(venue.menu.url),menuText(n.name.toString()+" Menu")):(menuUrl(""),menuText("No menu registered on FourSquare")),"bestPhoto"in venue?img(venue.bestPhoto.prefix+"350x275"+venue.bestPhoto.suffix):(img(""),imgText("No Image available")),"url"in venue?(websiteUrl(venue.url),websiteText("Website")):(websiteUrl(""),websiteText("No website registered on FourSquare")),o.restaurantAddress("address"in venue.location?venue.location.address+", "+venue.location.city:venue.location.city),"hours"in venue&&o.restaurantStatus(venue.hours.status),o.restaurantPhone(venue.contact.formattedPhone),venue.categories.forEach(function(e){category=e.shortName,o.categories.push(category)})},error:function(){fourSquareError()}})},o.fourSquareError=function(){o.restaurantStatus("Foursquare is not currently available")},o.showMarkerWindow=function(e){e.infowindow.content='<div id="content"><h4 class="heading">'+e.name+"</h4></div>",e.infowindow.open(map,e.marker)},o.hideMarkerWindow=function(e,o){e.infowindow.close(map,e.marker)}},geocoder,map,infowindow;$().ready(initializeMap,ko.applyBindings(viewModel));